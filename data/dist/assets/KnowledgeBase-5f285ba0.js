import{Y as g,a4 as M,aO as A,j as u,m as n,d as a,H as j,c as V,w as i,e as h,b as l,n as m,I as H,F as K,l as B,T as S,ae as W,o as d,t as c,v,B as f,C as w,E as _,W as E,Q as D,aI as q,a5 as U,S as F,z as x,V as P,f as y,K as G,L as I,ax as J,ay as R,P as O,A as Y,J as Q,aH as X,U as Z,a2 as $,a3 as ee}from"./index-f4130869.js";import{C as le}from"./ConsoleDisplayer-92b1186c.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./common-5ba6cde7.js";const se={name:"KnowledgeBase",components:{ConsoleDisplayer:le},data(){return{installed:!0,installing:!1,kbCollections:[],showCreateDialog:!1,showEmojiPicker:!1,newKB:{name:"",emoji:"ðŸ™‚",description:"",embedding_provider_id:""},snackbar:{show:!1,text:"",color:"success"},emojiCategories:[{name:"ç¬‘è„¸å’Œæƒ…æ„Ÿ",emojis:["ðŸ˜€","ðŸ˜ƒ","ðŸ˜„","ðŸ˜","ðŸ˜†","ðŸ˜…","ðŸ¤£","ðŸ˜‚","ðŸ™‚","ðŸ™ƒ","ðŸ˜‰","ðŸ˜Š","ðŸ˜‡","ðŸ¥°","ðŸ˜","ðŸ¤©","ðŸ˜˜"]},{name:"åŠ¨ç‰©å’Œè‡ªç„¶",emojis:["ðŸ¶","ðŸ±","ðŸ­","ðŸ¹","ðŸ°","ðŸ¦Š","ðŸ»","ðŸ¼","ðŸ¨","ðŸ¯","ðŸ¦","ðŸ®","ðŸ·","ðŸ¸","ðŸµ"]},{name:"é£Ÿç‰©å’Œé¥®æ–™",emojis:["ðŸ","ðŸŽ","ðŸ","ðŸŠ","ðŸ‹","ðŸŒ","ðŸ‰","ðŸ‡","ðŸ“","ðŸˆ","ðŸ’","ðŸ‘","ðŸ¥­","ðŸ","ðŸ¥¥"]},{name:"æ´»åŠ¨å’Œç‰©å“",emojis:["âš½","ðŸ€","ðŸˆ","âš¾","ðŸ¥Ž","ðŸŽ¾","ðŸ","ðŸ‰","ðŸŽ±","ðŸ“","ðŸ¸","ðŸ¥…","ðŸ’","ðŸ‘","ðŸ¥"]},{name:"æ—…è¡Œå’Œåœ°ç‚¹",emojis:["ðŸš—","ðŸš•","ðŸš™","ðŸšŒ","ðŸšŽ","ðŸŽï¸","ðŸš“","ðŸš‘","ðŸš’","ðŸš","ðŸšš","ðŸš›","ðŸšœ","ðŸ›´","ðŸš²"]},{name:"ç¬¦å·å’Œæ——å¸œ",emojis:["â¤ï¸","ðŸ§¡","ðŸ’›","ðŸ’š","ðŸ’™","ðŸ’œ","ðŸ–¤","ðŸ¤","ðŸ¤Ž","ðŸ’”","â£ï¸","ðŸ’•","ðŸ’ž","ðŸ’“","ðŸ’—"]}],showContentDialog:!1,currentKB:{collection_name:"",emoji:""},activeTab:"upload",selectedFile:null,chunkSize:null,overlap:null,uploading:!1,searchQuery:"",searchResults:[],searching:!1,searchPerformed:!1,topK:5,showDeleteDialog:!1,deleteTarget:{collection_name:""},deleting:!1,embeddingProviderConfigs:[]}},mounted(){this.checkPlugin(),this.getEmbeddingProviderList()},methods:{embeddingModelProps(t){return{title:t.embedding_model,subtitle:`æä¾›å•† ID: ${t.id} | åµŒå…¥æ¨¡åž‹ç»´åº¦: ${t.embedding_dimensions}`}},checkPlugin(){g.get("/api/plugin/get?name=astrbot_plugin_knowledge_base").then(t=>{t.data.status!=="ok"&&this.showSnackbar("æ’ä»¶æœªå®‰è£…æˆ–ä¸å¯ç”¨","error"),t.data.data.length>0?(this.installed=!0,this.getKBCollections()):this.installed=!1}).catch(t=>{console.error("Error checking plugin:",t),this.showSnackbar("æ£€æŸ¥æ’ä»¶å¤±è´¥","error")})},installPlugin(){this.installing=!0,g.post("/api/plugin/install",{url:"https://github.com/lxfight/astrbot_plugin_knowledge_base",proxy:localStorage.getItem("selectedGitHubProxy")||""}).then(t=>{t.data.status==="ok"?this.checkPlugin():this.showSnackbar(t.data.message||"å®‰è£…å¤±è´¥","error")}).catch(t=>{console.error("Error installing plugin:",t),this.showSnackbar("å®‰è£…æ’ä»¶å¤±è´¥","error")}).finally(()=>{this.installing=!1})},getKBCollections(){g.get("/api/plug/alkaid/kb/collections").then(t=>{this.kbCollections=t.data.data}).catch(t=>{console.error("Error fetching knowledge base collections:",t),this.showSnackbar("èŽ·å–çŸ¥è¯†åº“åˆ—è¡¨å¤±è´¥","error")})},createCollection(t,e,z){typeof this.newKB.embedding_provider_id=="object"&&(this.newKB.embedding_provider_id=this.newKB.embedding_provider_id.id||""),g.post("/api/plug/alkaid/kb/create_collection",{collection_name:t,emoji:e,description:z,embedding_provider_id:this.newKB.embedding_provider_id||""}).then(b=>{b.data.status==="ok"?(this.showSnackbar("çŸ¥è¯†åº“åˆ›å»ºæˆåŠŸ"),this.getKBCollections(),this.showCreateDialog=!1,this.resetNewKB()):this.showSnackbar(b.data.message||"åˆ›å»ºå¤±è´¥","error")}).catch(b=>{console.error("Error creating knowledge base collection:",b),this.showSnackbar("åˆ›å»ºçŸ¥è¯†åº“å¤±è´¥","error")})},submitCreateForm(){if(!this.newKB.name){this.showSnackbar("è¯·è¾“å…¥çŸ¥è¯†åº“åç§°","warning");return}this.createCollection(this.newKB.name,this.newKB.emoji||"ðŸ™‚",this.newKB.description,this.newKB.embedding_provider_id||"")},resetNewKB(){this.newKB={name:"",emoji:"ðŸ™‚",description:"",embedding_provider:""}},openKnowledgeBase(t){this.currentKB=t,this.showContentDialog=!0,this.resetContentDialog()},resetContentDialog(){this.activeTab="upload",this.selectedFile=null,this.searchQuery="",this.searchResults=[],this.searchPerformed=!1,this.chunkSize=null,this.overlap=null},triggerFileInput(){this.$refs.fileInput.click()},onFileSelected(t){const e=t.target.files;e.length>0&&(this.selectedFile=e[0])},onFileDrop(t){const e=t.dataTransfer.files;e.length>0&&(this.selectedFile=e[0])},getFileIcon(t){switch(t.split(".").pop().toLowerCase()){case"pdf":return"mdi-file-pdf-box";case"doc":case"docx":return"mdi-file-word-box";case"xls":case"xlsx":return"mdi-file-excel-box";case"ppt":case"pptx":return"mdi-file-powerpoint-box";case"txt":return"mdi-file-document-outline";default:return"mdi-file-outline"}},uploadFile(){if(!this.selectedFile){this.showSnackbar("è¯·å…ˆé€‰æ‹©æ–‡ä»¶","warning");return}this.uploading=!0;const t=new FormData;t.append("file",this.selectedFile),t.append("collection_name",this.currentKB.collection_name),this.chunkSize&&this.chunkSize>0&&t.append("chunk_size",this.chunkSize),this.overlap&&this.overlap>=0&&t.append("chunk_overlap",this.overlap),g.post("/api/plug/alkaid/kb/collection/add_file",t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{e.data.status==="ok"?(this.showSnackbar("æ“ä½œæˆåŠŸ: "+e.data.message),this.selectedFile=null,this.getKBCollections()):this.showSnackbar(e.data.message||"ä¸Šä¼ å¤±è´¥","error")}).catch(e=>{console.error("Error uploading file:",e),this.showSnackbar("æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}).finally(()=>{this.uploading=!1})},searchKnowledgeBase(){if(!this.searchQuery.trim()){this.showSnackbar("è¯·è¾“å…¥æœç´¢å†…å®¹","warning");return}this.searching=!0,this.searchPerformed=!0,g.get("/api/plug/alkaid/kb/collection/search",{params:{collection_name:this.currentKB.collection_name,query:this.searchQuery,top_k:this.topK}}).then(t=>{t.data.status==="ok"?(this.searchResults=t.data.data||[],this.searchResults.length===0&&this.showSnackbar("æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å†…å®¹","info")):(this.showSnackbar(t.data.message||"æœç´¢å¤±è´¥","error"),this.searchResults=[])}).catch(t=>{console.error("Error searching knowledge base:",t),this.showSnackbar("æœç´¢çŸ¥è¯†åº“å¤±è´¥","error"),this.searchResults=[]}).finally(()=>{this.searching=!1})},showSnackbar(t,e="success"){this.snackbar.text=t,this.snackbar.color=e,this.snackbar.show=!0},selectEmoji(t){this.newKB.emoji=t,this.showEmojiPicker=!1},confirmDelete(t){this.deleteTarget=t,this.showDeleteDialog=!0},deleteKnowledgeBase(){if(!this.deleteTarget.collection_name){this.showSnackbar("åˆ é™¤ç›®æ ‡ä¸å­˜åœ¨","error");return}this.deleting=!0,g.get("/api/plug/alkaid/kb/collection/delete",{params:{collection_name:this.deleteTarget.collection_name}}).then(t=>{t.data.status==="ok"?(this.showSnackbar("çŸ¥è¯†åº“åˆ é™¤æˆåŠŸ"),this.getKBCollections(),this.showDeleteDialog=!1):this.showSnackbar(t.data.message||"åˆ é™¤å¤±è´¥","error")}).catch(t=>{console.error("Error deleting knowledge base:",t),this.showSnackbar("åˆ é™¤çŸ¥è¯†åº“å¤±è´¥","error")}).finally(()=>{this.deleting=!1})},getEmbeddingProviderList(){g.get("/api/config/provider/list",{params:{provider_type:"embedding"}}).then(t=>{if(t.data.status==="ok")this.embeddingProviderConfigs=t.data.data||[];else return this.showSnackbar(t.data.message||"èŽ·å–åµŒå…¥æ¨¡åž‹åˆ—è¡¨å¤±è´¥","error"),[]}).catch(t=>(console.error("Error fetching embedding providers:",t),this.showSnackbar("èŽ·å–åµŒå…¥æ¨¡åž‹åˆ—è¡¨å¤±è´¥","error"),[]))},openUrl(t){window.open(t,"_blank")}}},p=t=>($("data-v-4845974d"),t=t(),ee(),t),ie={class:"flex-grow-1",style:{display:"flex","flex-direction":"column",height:"100%"}},oe={style:{"flex-grow":"1",width:"100%",border:"1px solid #eee","border-radius":"8px",padding:"16px"}},ne={key:0,class:"d-flex align-center justify-center flex-column",style:{"flex-grow":"1",width:"100%",height:"100%"}},ae={key:1,class:"d-flex align-center justify-center flex-column",style:{"flex-grow":"1",width:"100%",height:"100%"}},re=p(()=>n("h2",null,"è¿˜æ²¡æœ‰çŸ¥è¯†åº“ï¼Œå¿«åˆ›å»ºä¸€ä¸ªå§ï¼ðŸ™‚",-1)),de={key:2},ce={class:"mb-4"},ue={class:"kb-grid"},me=["onClick"],he=p(()=>n("div",{class:"book-spine"},null,-1)),pe={class:"book-content"},ge={class:"emoji-container"},fe={class:"kb-emoji"},_e={class:"kb-name"},be={class:"kb-count"},ke={class:"kb-actions"},ve=p(()=>n("div",{style:{padding:"16px","text-align":"center"}},[n("small",{style:{color:"#a3a3a3"}},"Tips: åœ¨èŠå¤©é¡µé¢é€šè¿‡ /kb æŒ‡ä»¤äº†è§£å¦‚ä½•ä½¿ç”¨ï¼")],-1)),we={style:{width:"100%",display:"flex","align-items":"center","justify-content":"center"}},xe=p(()=>n("small",null,"Tips: ä¸€æ—¦é€‰æ‹©äº†ä¸€ä¸ªçŸ¥è¯†åº“çš„åµŒå…¥æ¨¡åž‹ï¼Œè¯·ä¸è¦å†ä¿®æ”¹è¯¥æä¾›å•†çš„æ¨¡åž‹æˆ–è€…å‘é‡ç»´åº¦ä¿¡æ¯ï¼Œå¦åˆ™å°†ä¸¥é‡å½±å“è¯¥çŸ¥è¯†åº“çš„å¬å›žçŽ‡ç”šè‡³æŠ¥é”™ã€‚",-1)),ye={class:"emoji-picker"},Ce={class:"text-subtitle-2 mb-2"},Ve={class:"emoji-grid"},Ke=["onClick"],Be={class:"me-2 emoji-sm"},Se={key:0,class:"px-6 py-2"},De={style:{"margin-left":"8px"}},je={class:"upload-container pa-4"},Fe=p(()=>n("div",{class:"text-center mb-4"},[n("h3",null,"ä¸Šä¼ æ–‡ä»¶åˆ°çŸ¥è¯†åº“"),n("p",{class:"text-subtitle-1"},"æ”¯æŒ txtã€pdfã€wordã€excel ç­‰å¤šç§æ ¼å¼")],-1)),Pe=p(()=>n("p",{class:"mt-2"},"æ‹–æ”¾æ–‡ä»¶åˆ°è¿™é‡Œæˆ–ç‚¹å‡»ä¸Šä¼ ",-1)),ze=p(()=>n("span",{class:"text-subtitle-1 font-weight-bold"},"åˆ†ç‰‡è®¾ç½®",-1)),Te=p(()=>n("span",null,[a(" åˆ†ç‰‡é•¿åº¦å†³å®šæ¯å—æ–‡æœ¬çš„å¤§å°ï¼Œé‡å é•¿åº¦å†³å®šç›¸é‚»æ–‡æœ¬å—ä¹‹é—´çš„é‡å ç¨‹åº¦ã€‚"),n("br"),a(" è¾ƒå°çš„åˆ†ç‰‡æ›´ç²¾ç¡®ä½†ä¼šå¢žåŠ æ•°é‡ï¼Œé€‚å½“çš„é‡å å¯æé«˜æ£€ç´¢å‡†ç¡®æ€§ã€‚ ")],-1)),Ee={class:"d-flex flex-wrap",style:{gap:"8px"}},Ue={key:0,class:"selected-files mt-4"},Ie={type:"info",variant:"tonal",class:"d-flex align-center"},Re={style:{"font-weight":"1000"}},Qe={class:"text-center mt-4"},Le={key:1,class:"upload-progress mt-4"},Ne={class:"search-container pa-4"},Me={class:"search-results mt-4"},Ae={key:0},He=p(()=>n("p",{class:"text-center mt-4"},"æ­£åœ¨æœç´¢...",-1)),We={key:1},qe=p(()=>n("h3",{class:"mb-2"},"æœç´¢ç»“æžœ",-1)),Ge={class:"d-flex align-center mb-2"},Je={class:"text-caption text-medium-emphasis"},Oe={class:"search-content"},Ye={key:2},Xe={class:"font-weight-bold"},Ze=p(()=>n("p",{class:"text-red"},"æ­¤æ“ä½œä¸å¯é€†ï¼Œæ‰€æœ‰çŸ¥è¯†åº“å†…å®¹å°†è¢«æ°¸ä¹…åˆ é™¤ã€‚",-1));function $e(t,e,z,b,s,r){const L=M("ConsoleDisplayer"),T=A("class");return d(),u("div",ie,[n("div",oe,[s.installed?s.kbCollections.length==0?(d(),u("div",ae,[re,l(m,{style:{"margin-top":"16px"},variant:"tonal",color:"primary",onClick:e[1]||(e[1]=o=>s.showCreateDialog=!0)},{default:i(()=>[a(" åˆ›å»ºçŸ¥è¯†åº“ ")]),_:1})])):(d(),u("div",de,[n("h2",ce,[a("çŸ¥è¯†åº“åˆ—è¡¨ "),j((d(),V(h,{size:"x-small",color:"grey",onClick:e[2]||(e[2]=o=>r.openUrl("https://astrbot.app/use/knowledge-base.html"))},{default:i(()=>[a("mdi-information-outline")]),_:1})),[[T,t.ml-2]])]),l(m,{class:"mb-4","prepend-icon":"mdi-plus",variant:"tonal",color:"primary",onClick:e[3]||(e[3]=o=>s.showCreateDialog=!0)},{default:i(()=>[a(" åˆ›å»ºçŸ¥è¯†åº“ ")]),_:1}),l(m,{class:"mb-4 ml-4","prepend-icon":"mdi-cog",variant:"tonal",color:"success",onClick:e[4]||(e[4]=o=>t.$router.push("/extension?open_config=astrbot_plugin_knowledge_base"))},{default:i(()=>[a(" é…ç½® ")]),_:1}),n("div",ue,[(d(!0),u(K,null,B(s.kbCollections,(o,k)=>(d(),u("div",{key:k,class:"kb-card",onClick:C=>r.openKnowledgeBase(o)},[he,n("div",pe,[n("div",ge,[n("span",fe,c(o.emoji||"ðŸ™‚"),1)]),n("div",_e,c(o.collection_name),1),n("div",be,c(o.count||0)+" æ¡çŸ¥è¯†",1),n("div",ke,[l(m,{icon:"",variant:"text",size:"small",color:"error",onClick:v(C=>r.confirmDelete(o),["stop"])},{default:i(()=>[l(h,null,{default:i(()=>[a("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])],8,me))),128))]),ve])):(d(),u("div",ne,[n("h2",null,[a("è¿˜æ²¡æœ‰å®‰è£…çŸ¥è¯†åº“æ’ä»¶ "),j((d(),V(h,{size:"small",color:"grey",onClick:e[0]||(e[0]=o=>r.openUrl("https://astrbot.app/use/knowledge-base.html"))},{default:i(()=>[a("mdi-information-outline")]),_:1})),[[T,t.ml-2]])]),l(m,{style:{"margin-top":"16px"},variant:"tonal",color:"primary",onClick:r.installPlugin,loading:s.installing},{default:i(()=>[a(" ç«‹å³å®‰è£… ")]),_:1},8,["onClick","loading"]),j(l(L,{style:{"background-color":"#fff","max-height":"300px","margin-top":"16px","max-width":"100%"},"show-level-btns":!1},null,512),[[H,s.installing]])]))]),l(S,{modelValue:s.showCreateDialog,"onUpdate:modelValue":e[10]||(e[10]=o=>s.showCreateDialog=o),"max-width":"500px"},{default:i(()=>[l(f,null,{default:i(()=>[l(w,{class:"text-h4"},{default:i(()=>[a("åˆ›å»ºæ–°çŸ¥è¯†åº“")]),_:1}),l(_,null,{default:i(()=>[n("div",we,[n("span",{id:"emoji-display",onClick:e[5]||(e[5]=o=>s.showEmojiPicker=!0)},c(s.newKB.emoji||"ðŸ™‚"),1)]),l(E,{onSubmit:v(r.submitCreateForm,["prevent"])},{default:i(()=>[l(D,{variant:"outlined",modelValue:s.newKB.name,"onUpdate:modelValue":e[6]||(e[6]=o=>s.newKB.name=o),label:"çŸ¥è¯†åº“åç§°",required:""},null,8,["modelValue"]),l(q,{modelValue:s.newKB.description,"onUpdate:modelValue":e[7]||(e[7]=o=>s.newKB.description=o),label:"æè¿°",variant:"outlined",placeholder:"çŸ¥è¯†åº“çš„ç®€çŸ­æè¿°...",rows:"3"},null,8,["modelValue"]),l(U,{modelValue:s.newKB.embedding_provider_id,"onUpdate:modelValue":e[8]||(e[8]=o=>s.newKB.embedding_provider_id=o),items:s.embeddingProviderConfigs,"item-props":r.embeddingModelProps,label:"Embedding(åµŒå…¥)æ¨¡åž‹",variant:"outlined",class:"mt-2"},null,8,["modelValue","items","item-props"]),xe]),_:1},8,["onSubmit"])]),_:1}),l(F,null,{default:i(()=>[l(x),l(m,{color:"error",variant:"text",onClick:e[9]||(e[9]=o=>s.showCreateDialog=!1)},{default:i(()=>[a("å–æ¶ˆ")]),_:1}),l(m,{color:"primary",variant:"text",onClick:r.submitCreateForm},{default:i(()=>[a("åˆ›å»º")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(S,{modelValue:s.showEmojiPicker,"onUpdate:modelValue":e[12]||(e[12]=o=>s.showEmojiPicker=o),"max-width":"400px"},{default:i(()=>[l(f,null,{default:i(()=>[l(w,{class:"text-h6"},{default:i(()=>[a("é€‰æ‹©è¡¨æƒ…")]),_:1}),l(_,null,{default:i(()=>[n("div",ye,[(d(!0),u(K,null,B(s.emojiCategories,(o,k)=>(d(),u("div",{key:k,class:"mb-4"},[n("div",Ce,c(o.name),1),n("div",Ve,[(d(!0),u(K,null,B(o.emojis,(C,N)=>(d(),u("div",{key:N,class:"emoji-item",onClick:el=>r.selectEmoji(C)},c(C),9,Ke))),128))])]))),128))])]),_:1}),l(F,null,{default:i(()=>[l(x),l(m,{color:"primary",variant:"text",onClick:e[11]||(e[11]=o=>s.showEmojiPicker=!1)},{default:i(()=>[a("å…³é—­")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(S,{modelValue:s.showContentDialog,"onUpdate:modelValue":e[25]||(e[25]=o=>s.showContentDialog=o),"max-width":"1000px"},{default:i(()=>[l(f,null,{default:i(()=>[l(w,{class:"d-flex align-center"},{default:i(()=>[n("div",Be,c(s.currentKB.emoji||"ðŸ™‚"),1),n("span",null,c(s.currentKB.collection_name)+" - çŸ¥è¯†åº“ç®¡ç†",1),l(x),l(m,{variant:"plain",icon:"",onClick:e[13]||(e[13]=o=>s.showContentDialog=!1)},{default:i(()=>[l(h,null,{default:i(()=>[a("mdi-close")]),_:1})]),_:1})]),_:1}),s.currentKB._embedding_provider_config?(d(),u("div",Se,[l(P,{class:"mr-2",color:"primary",variant:"tonal",size:"small",rounded:"sm"},{default:i(()=>[l(h,{start:"",size:"small"},{default:i(()=>[a("mdi-database")]),_:1}),a(" åµŒå…¥æ¨¡åž‹: "+c(s.currentKB._embedding_provider_config.embedding_model),1)]),_:1}),l(P,{color:"secondary",variant:"tonal",size:"small",rounded:"sm"},{default:i(()=>[l(h,{start:"",size:"small"},{default:i(()=>[a("mdi-vector-point")]),_:1}),a(" å‘é‡ç»´åº¦: "+c(s.currentKB._embedding_provider_config.embedding_dimensions),1)]),_:1}),n("small",De,"ðŸ’¡ ä½¿ç”¨æ–¹å¼: åœ¨èŠå¤©é¡µä¸­è¾“å…¥ â€œ/kb use "+c(s.currentKB.collection_name)+"â€",1)])):y("",!0),l(_,null,{default:i(()=>[l(G,{modelValue:s.activeTab,"onUpdate:modelValue":e[14]||(e[14]=o=>s.activeTab=o)},{default:i(()=>[l(I,{value:"upload"},{default:i(()=>[a("ä¸Šä¼ æ–‡ä»¶")]),_:1}),l(I,{value:"search"},{default:i(()=>[a("æœç´¢å†…å®¹")]),_:1})]),_:1},8,["modelValue"]),l(J,{modelValue:s.activeTab,"onUpdate:modelValue":e[24]||(e[24]=o=>s.activeTab=o),class:"mt-4"},{default:i(()=>[l(R,{value:"upload"},{default:i(()=>[n("div",je,[Fe,n("div",{class:"upload-zone",onDragover:e[16]||(e[16]=v(()=>{},["prevent"])),onDrop:e[17]||(e[17]=v((...o)=>r.onFileDrop&&r.onFileDrop(...o),["prevent"])),onClick:e[18]||(e[18]=(...o)=>r.triggerFileInput&&r.triggerFileInput(...o))},[n("input",{type:"file",ref:"fileInput",style:{display:"none"},onChange:e[15]||(e[15]=(...o)=>r.onFileSelected&&r.onFileSelected(...o))},null,544),l(h,{size:"48",color:"primary"},{default:i(()=>[a("mdi-cloud-upload")]),_:1}),Pe],32),l(f,{class:"mt-4 chunk-settings-card",variant:"outlined",color:"grey-lighten-4"},{default:i(()=>[l(w,{class:"pa-4 pb-0 d-flex align-center"},{default:i(()=>[l(h,{color:"primary",class:"mr-2"},{default:i(()=>[a("mdi-puzzle-outline")]),_:1}),ze,l(O,{location:"top"},{activator:i(({props:o})=>[l(h,Y(o,{class:"ml-2",size:"small",color:"grey"}),{default:i(()=>[a(" mdi-information-outline ")]),_:2},1040)]),default:i(()=>[Te]),_:1})]),_:1}),l(_,{class:"pa-4 pt-2"},{default:i(()=>[n("div",Ee,[l(D,{modelValue:s.chunkSize,"onUpdate:modelValue":e[19]||(e[19]=o=>s.chunkSize=o),label:"åˆ†ç‰‡é•¿åº¦",type:"number",hint:"æŽ§åˆ¶æ¯ä¸ªæ–‡æœ¬å—å¤§å°ï¼Œç•™ç©ºä½¿ç”¨é»˜è®¤å€¼","persistent-hint":"",variant:"outlined",density:"comfortable",class:"flex-grow-1 chunk-field","prepend-inner-icon":"mdi-text-box-outline",min:"50"},null,8,["modelValue"]),l(D,{modelValue:s.overlap,"onUpdate:modelValue":e[20]||(e[20]=o=>s.overlap=o),label:"é‡å é•¿åº¦",type:"number",hint:"æŽ§åˆ¶ç›¸é‚»æ–‡æœ¬å—é‡å åº¦ï¼Œç•™ç©ºä½¿ç”¨é»˜è®¤å€¼","persistent-hint":"",variant:"outlined",density:"comfortable",class:"flex-grow-1 chunk-field","prepend-inner-icon":"mdi-vector-intersection",min:"0"},null,8,["modelValue"])])]),_:1})]),_:1}),s.selectedFile?(d(),u("div",Ue,[n("div",Ie,[n("div",null,[l(h,{class:"me-2"},{default:i(()=>[a(c(r.getFileIcon(s.selectedFile.name)),1)]),_:1}),n("span",Re,c(s.selectedFile.name),1)]),l(m,{size:"small",color:"error",variant:"text",onClick:e[21]||(e[21]=o=>s.selectedFile=null)},{default:i(()=>[l(h,null,{default:i(()=>[a("mdi-close")]),_:1})]),_:1})]),n("div",Qe,[l(m,{color:"primary",variant:"elevated",loading:s.uploading,disabled:!s.selectedFile,onClick:r.uploadFile},{default:i(()=>[a(" ä¸Šä¼ åˆ°çŸ¥è¯†åº“ ")]),_:1},8,["loading","disabled","onClick"])])])):y("",!0),s.uploading?(d(),u("div",Le,[l(Q,{indeterminate:"",color:"primary"})])):y("",!0)])]),_:1}),l(R,{value:"search"},{default:i(()=>[n("div",Ne,[l(E,{onSubmit:v(r.searchKnowledgeBase,["prevent"]),class:"d-flex align-center"},{default:i(()=>[l(D,{modelValue:s.searchQuery,"onUpdate:modelValue":e[22]||(e[22]=o=>s.searchQuery=o),label:"æœç´¢çŸ¥è¯†åº“å†…å®¹","append-icon":"mdi-magnify",variant:"outlined",class:"flex-grow-1 me-2","onClick:append":r.searchKnowledgeBase,onKeyup:X(r.searchKnowledgeBase,["enter"]),placeholder:"è¾“å…¥å…³é”®è¯æœç´¢çŸ¥è¯†åº“å†…å®¹...","hide-details":""},null,8,["modelValue","onClick:append","onKeyup"]),l(U,{modelValue:s.topK,"onUpdate:modelValue":e[23]||(e[23]=o=>s.topK=o),items:[3,5,10,20],label:"ç»“æžœæ•°é‡",variant:"outlined",style:{"max-width":"120px"},"hide-details":""},null,8,["modelValue"])]),_:1},8,["onSubmit"]),n("div",Me,[s.searching?(d(),u("div",Ae,[l(Q,{indeterminate:"",color:"primary"}),He])):s.searchResults.length>0?(d(),u("div",We,[qe,(d(!0),u(K,null,B(s.searchResults,(o,k)=>(d(),V(f,{key:k,class:"mb-4 search-result-card",variant:"outlined"},{default:i(()=>[l(_,null,{default:i(()=>[n("div",Ge,[l(h,{class:"me-2",size:"small",color:"primary"},{default:i(()=>[a("mdi-file-document-outline")]),_:1}),n("span",Je,c(o.metadata.source),1),l(x),o.score?(d(),V(P,{key:0,size:"small",color:"primary",variant:"tonal"},{default:i(()=>[a(" ç›¸å…³åº¦: "+c(Math.round(o.score*100))+"% ",1)]),_:2},1024)):y("",!0)]),n("div",Oe,c(o.content),1)]),_:2},1024)]),_:2},1024))),128))])):s.searchPerformed?(d(),u("div",Ye,[l(Z,{type:"info",variant:"tonal"},{default:i(()=>[a(" æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å†…å®¹ ")]),_:1})])):y("",!0)])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(S,{modelValue:s.showDeleteDialog,"onUpdate:modelValue":e[27]||(e[27]=o=>s.showDeleteDialog=o),"max-width":"400px"},{default:i(()=>[l(f,null,{default:i(()=>[l(w,{class:"text-h5"},{default:i(()=>[a("ç¡®è®¤åˆ é™¤")]),_:1}),l(_,null,{default:i(()=>[n("p",null,[a("æ‚¨ç¡®å®šè¦åˆ é™¤çŸ¥è¯†åº“ "),n("span",Xe,c(s.deleteTarget.collection_name),1),a(" å—ï¼Ÿ")]),Ze]),_:1}),l(F,null,{default:i(()=>[l(x),l(m,{color:"grey-darken-1",variant:"text",onClick:e[26]||(e[26]=o=>s.showDeleteDialog=!1)},{default:i(()=>[a("å–æ¶ˆ")]),_:1}),l(m,{color:"error",variant:"text",onClick:r.deleteKnowledgeBase,loading:s.deleting},{default:i(()=>[a("åˆ é™¤")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(W,{modelValue:s.snackbar.show,"onUpdate:modelValue":e[28]||(e[28]=o=>s.snackbar.show=o),color:s.snackbar.color},{default:i(()=>[a(c(s.snackbar.text),1)]),_:1},8,["modelValue","color"])])}const ol=te(se,[["render",$e],["__scopeId","data-v-4845974d"]]);export{ol as default};
