import{H as ie,E as Me}from"./github-f6dc265f.js";import{W as Ie}from"./WaitingForRestart-82da020f.js";import{A as Ae}from"./AstrBotConfig-4a1033c3.js";import{C as Be}from"./ConsoleDisplayer-92b1186c.js";import{r as g,aa as be,o as i,c as y,w as e,b as a,C as O,n as f,e as m,d as o,R as xe,E as M,m as n,f as w,j as h,a6 as se,t as p,S as F,z as I,B as U,T as G,Y as x,ab as q,ac as Ce,ad as Ne,a8 as N,ae as He,F as J,a9 as H,af as Oe,ag as Fe,ah as Ve,Q as Ge,A as $e,ai as We,aj as Ke,O as ze,V as te,P as E,l as le,ak as qe,al as Je,am as Qe,an as Ye,ao as Xe,k as Ze,i as Q,g as Y,ap as ea,aq as aa,J as ta,a2 as la,a3 as sa}from"./index-f4130869.js";import{m as Ee}from"./marked.esm-01fb2abe.js";import{u as oa}from"./common-5ba6cde7.js";import{_ as na}from"./_plugin-vue_export-helper-c27b6911.js";import"./customizer-b207e117.js";import"./config-aff687d2.js";import"./index-34d28bc5.js";const ra=n("span",{class:"text-h5"},"插件说明文档",-1),ia={class:"d-flex justify-space-between mb-4"},da={key:0,class:"d-flex flex-column align-center justify-center",style:{height:"100%"}},ua=n("p",{class:"text-body-1 text-center"},"正在加载README文档...",-1),ca=["innerHTML"],fa={key:2,class:"d-flex flex-column align-center justify-center",style:{height:"100%"}},ma={class:"text-body-1 text-center mb-4"},pa={key:3,class:"d-flex flex-column align-center justify-center",style:{height:"100%"}},_a=n("p",{class:"text-body-1 text-center mb-4"},[o("该插件未提供文档链接或GitHub仓库地址。"),n("br"),o("请查看插件市场或联系插件作者获取更多信息。")],-1),va={name:"ReadmeDialog",computed:{_show:{get(){return this.show},set(z){this.$emit("update:show",z)}}}},ga=Object.assign(va,{props:{show:{type:Boolean,default:!1},pluginName:{type:String,default:""},repoUrl:{type:String,default:null}},emits:["update:show"],setup(z,{emit:de}){const _=z,b=g(null),P=g(null),S=g(!1);be(()=>_.show,d=>{d&&_.pluginName&&A()}),be(()=>_.pluginName,d=>{_.show&&d&&A()});async function A(){if(_.pluginName){S.value=!0,b.value=null,P.value=null;try{const d=await x.get(`/api/plugin/readme?name=${_.pluginName}`);d.data.status==="ok"?b.value=d.data.data.content:P.value=d.data.message||"获取README失败"}catch(d){P.value=d.message||"获取README时发生错误"}finally{S.value=!1}}}function D(){_.repoUrl&&window.open(_.repoUrl,"_blank")}function V(d){return d?(Ee.setOptions({highlight:function(v,k){if(k&&ie.getLanguage(k))try{return ie.highlight(v,{language:k}).value}catch(W){console.error(W)}return ie.highlightAuto(v).value},gfm:!0,breaks:!0,headerIds:!0,mangle:!1}),Ee(d)):""}function X(){A()}return(d,v)=>(i(),y(G,{modelValue:d._show,"onUpdate:modelValue":v[4]||(v[4]=k=>d._show=k),width:"800",persistent:""},{default:e(()=>[a(U,null,{default:e(()=>[a(O,{class:"d-flex justify-space-between align-center"},{default:e(()=>[ra,a(f,{icon:"",onClick:v[0]||(v[0]=k=>d.$emit("update:show",!1))},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-close")]),_:1})]),_:1})]),_:1}),a(xe),a(M,{style:{height:"70vh","overflow-y":"auto"}},{default:e(()=>[n("div",ia,[z.repoUrl?(i(),y(f,{key:0,color:"primary","prepend-icon":"mdi-github",onClick:v[1]||(v[1]=k=>D())},{default:e(()=>[o(" 在GitHub中查看仓库 ")]),_:1})):w("",!0),a(f,{color:"secondary","prepend-icon":"mdi-refresh",onClick:v[2]||(v[2]=k=>X())},{default:e(()=>[o(" 刷新文档 ")]),_:1})]),S.value?(i(),h("div",da,[a(se,{indeterminate:"",color:"primary",size:"64",class:"mb-4"}),ua])):b.value?(i(),h("div",{key:1,class:"markdown-body",innerHTML:V(b.value)},null,8,ca)):P.value?(i(),h("div",fa,[a(m,{size:"64",color:"error",class:"mb-4"},{default:e(()=>[o("mdi-alert-circle-outline")]),_:1}),n("p",ma,p(P.value),1)])):(i(),h("div",pa,[a(m,{size:"64",color:"warning",class:"mb-4"},{default:e(()=>[o("mdi-file-question-outline")]),_:1}),_a]))]),_:1}),a(xe),a(F,null,{default:e(()=>[a(I),a(f,{color:"primary",variant:"tonal",onClick:v[3]||(v[3]=k=>d.$emit("update:show",!1))},{default:e(()=>[o(" 关闭 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});const C=z=>(la("data-v-fcccae10"),z=z(),sa(),z),ha={class:"plugin-page-icon d-flex justify-center align-center rounded-lg mr-4"},ya={class:"search-container rounded-lg"},ka={class:"text-body-1"},wa=C(()=>n("p",{class:"text-caption mt-2"},"详情请检查控制台",-1)),ba={key:0},xa=C(()=>n("span",{class:"ml-2"},"加载中...",-1)),Ca={class:"d-flex align-center py-2"},Va={class:"text-subtitle-1 font-weight-medium"},$a={key:0,class:"d-flex align-center mt-1"},za={class:"text-body-2 text-medium-emphasis"},Ea={class:"d-flex align-center"},Pa={class:"text-body-2"},Ua={class:"text-body-2"},Sa={class:"d-flex align-center"},Da={class:"text-center pa-8"},Ra=C(()=>n("div",{class:"text-h5 mb-2"},"暂无插件",-1)),Ta=C(()=>n("div",{class:"text-body-1 mb-4"},"尝试安装插件或者显示系统插件",-1)),La={key:1},ja=C(()=>n("div",{class:"text-h5 mb-2"},"暂无插件",-1)),Ma=C(()=>n("div",{class:"text-body-1 mb-4"},"尝试安装插件或者显示系统插件",-1)),Ia=C(()=>n("p",{class:"text-body-2 mb-4"},"设置每个插件在不同平台上的可用性，勾选表示启用",-1)),Aa={key:0,class:"text-center pa-8"},Ba=C(()=>n("div",{class:"text-h5 mb-2"},"未找到平台适配器",-1)),Na=C(()=>n("div",{class:"text-body-1 mb-4"},[o("请先在 "),n("strong",null,"平台管理"),o(" 中添加并配置平台适配器，然后再设置插件的平台可用性")],-1)),Ha=C(()=>n("th",{class:"text-left"},"插件名称",-1)),Oa={class:"d-flex align-center"},Fa={class:"d-flex align-center"},Ga={class:"text-caption text-grey"},Wa={key:1},Ka={key:1,class:"py-8 text-center"},qa={class:"text-h4 font-weight-bold"},Ja={style:{"margin-top":"32px"}},Qa=C(()=>n("h3",null,"日志",-1)),Ya={style:{"font-weight":"bold"}},Xa={style:{"font-weight":"bold"}},Za={__name:"ExtensionPage",setup(z){const de=oa(),_=q({data:[],message:""}),b=g(!1),P=g(""),S=g(!1),A=g("success"),D=g(!1),V=q({metadata:{},config:{}}),X=g([]),d=q({show:!1,title:"加载中...",statusCode:0,result:""}),v=g(!1),k=g({}),W=g(""),Pe=g(null),R=q({show:!1,pluginName:"",repoUrl:null}),B=g(!1),c=q({platforms:[],plugins:[],platform_enable:{}}),K=g(!1),T=g(!1),Z=g(""),ee=g(!1),Ue=[{title:"行为类型",key:"event_type_h"},{title:"描述",key:"desc",maxWidth:"250px"},{title:"具体类型",key:"type"},{title:"触发方式",key:"cmd"}],Se=[{title:"名称",key:"name",width:"200px"},{title:"描述",key:"desc",maxWidth:"250px"},{title:"版本",key:"version",width:"100px"},{title:"作者",key:"author",width:"100px"},{title:"状态",key:"status",width:"80px"},{title:"操作",key:"actions",sortable:!1,width:"220px"}],ue=Ce(()=>{var s;return b.value?_.data||[]:((s=_==null?void 0:_.data)==null?void 0:s.filter(l=>!l.reserved))||[]}),oe=Ce(()=>{if(!Z.value)return ue.value;const s=Z.value.toLowerCase();return ue.value.filter(l=>{var t,r,$;return((t=l.name)==null?void 0:t.toLowerCase().includes(s))||((r=l.desc)==null?void 0:r.toLowerCase().includes(s))||(($=l.author)==null?void 0:$.toLowerCase().includes(s))})}),De=()=>{b.value=!b.value},u=(s,l)=>{P.value=s,S.value=!0,A.value=l},ce=()=>{d.show=!1,d.title="加载中...",d.statusCode=0,d.result=""},fe=(s,l,t=2e3)=>{d.statusCode=s,d.result=l,t!==-1&&setTimeout(ce,t)},L=async()=>{ee.value=!0;try{const s=await x.get("/api/plugin/get");Object.assign(_,s.data),me()}catch(s){u(s,"error")}finally{ee.value=!1}},me=()=>{const s=new Map,l=new Map;X.value.forEach(t=>{t.repo&&s.set(t.repo.toLowerCase(),t),l.set(t.name,t)}),_.data.forEach(t=>{var we;const r=(we=t.repo)==null?void 0:we.toLowerCase(),$=r?s.get(r):null,re=l.get(t.name),j=$||re;j?(t.online_version=j.version,t.has_update=t.version!==j.version&&j.version!=="未知"):t.has_update=!1,t.logo=j==null?void 0:j.logo})},pe=async s=>{u("正在卸载"+s,"primary");try{const l=await x.post("/api/plugin/uninstall",{name:s});if(l.data.status==="error"){u(l.data.message,"error");return}Object.assign(_,l.data),u(l.data.message,"success"),L()}catch(l){u(l,"error")}},_e=async s=>{d.show=!0;try{const l=await x.post("/api/plugin/update",{name:s,proxy:localStorage.getItem("selectedGitHubProxy")||""});if(l.data.status==="error"){fe(2,l.data.message,-1);return}Object.assign(_,l.data),fe(1,l.data.message),setTimeout(async()=>{var t,r;u("正在刷新插件列表...","info",2e3);try{await L(),u("插件列表已刷新！","success")}catch($){const re=((r=(t=$.response)==null?void 0:t.data)==null?void 0:r.message)||$.message||String($);u(`刷新插件列表时发生错误: ${re}`,"error")}},1e3)}catch(l){u(l,"error")}},ve=async s=>{try{const l=await x.post("/api/plugin/on",{name:s.name});if(l.data.status==="error"){u(l.data.message,"error");return}u(l.data.message,"success"),L()}catch(l){u(l,"error")}},ge=async s=>{try{const l=await x.post("/api/plugin/off",{name:s.name});if(l.data.status==="error"){u(l.data.message,"error");return}u(l.data.message,"success"),L()}catch(l){u(l,"error")}},ne=async s=>{W.value=s,D.value=!0;try{const l=await x.get("/api/config/get?plugin_name="+s);V.metadata=l.data.data.metadata,V.config=l.data.data.config}catch(l){u(l,"error")}},Re=async()=>{try{const s=await x.post("/api/config/plugin/update?plugin_name="+W.value,V.config);s.data.status==="ok"?u(s.data.message,"success"):u(s.data.message,"error"),D.value=!1,V.metadata={},V.config={},L()}catch(s){u(s,"error")}},he=s=>{k.value=s,v.value=!0},ye=async s=>{try{const l=await x.post("/api/plugin/reload",{name:s});if(l.data.status==="error"){u(l.data.message,"error");return}u("重载成功","success"),L()}catch(l){u(l,"error")}},ke=s=>{R.pluginName=s.name,R.repoUrl=s.repo,R.show=!0},Te=async()=>{K.value=!0;try{const s=await x.get("/api/plugin/platform_enable/get");if(s.data.status==="error"){u(s.data.message,"error");return}c.platforms=s.data.data.platforms,c.plugins=s.data.data.plugins,c.platform_enable=s.data.data.platform_enable,c.platforms.length===0?u("未添加任何平台适配器，请先在平台管理中添加平台","warning"):c.platforms.forEach(l=>{c.platform_enable[l.name]||(c.platform_enable[l.name]={}),c.plugins.forEach(t=>{c.platform_enable[l.name][t.name]===void 0&&(c.platform_enable[l.name][t.name]=!0)})}),B.value=!0}catch(s){u("获取平台插件配置失败: "+s,"error")}finally{K.value=!1}},Le=async()=>{K.value=!0;try{const s=await x.post("/api/plugin/platform_enable/set",{platform_enable:c.platform_enable});if(s.data.status==="error"){u(s.data.message,"error");return}u(s.data.message,"success"),B.value=!1}catch(s){u("保存平台插件配置失败: "+s,"error")}finally{K.value=!1}},ae=(s,l,t=null)=>{c.platform_enable[s]||(c.platform_enable[s]={}),c.plugins.forEach(r=>{(t===null||r.reserved===t)&&(c.platform_enable[s][r.name]=l)})},je=s=>{c.platform_enable[s]||(c.platform_enable[s]={}),c.plugins.forEach(l=>{const t=c.platform_enable[s][l.name];c.platform_enable[s][l.name]=!t})};return Ne(async()=>{await L();const l=new URLSearchParams(window.location.search).get("open_config");l&&ne(l);try{const t=await de.getPluginCollections();X.value=t,me()}catch(t){console.error("获取插件市场数据失败:",t)}}),(s,l)=>(i(),h(J,null,[a(N,null,{default:e(()=>[a(H,{cols:"12",md:"12"},{default:e(()=>[a(U,{variant:"flat",class:"rounded-xl"},{default:e(()=>[a(Oe,null,{prepend:e(()=>[n("div",ha,[a(m,{size:"36",color:"primary"},{default:e(()=>[o("mdi-puzzle")]),_:1})])]),default:e(()=>[a(O,{class:"text-h4 font-weight-bold"},{default:e(()=>[o(" 已安装的插件 ")]),_:1}),a(Fe,{class:"text-subtitle-1 mt-1 text-medium-emphasis"},{default:e(()=>[o(" 管理已经安装的所有插件 ")]),_:1})]),_:1}),a(M,{class:"pt-2"},{default:e(()=>[a(N,{class:"mb-4"},{default:e(()=>[a(H,{cols:"12",sm:"6",md:"6",class:"d-flex align-center"},{default:e(()=>[a(Ve,{variant:"outlined",density:"comfortable",color:"primary"},{default:e(()=>[a(f,{onClick:l[0]||(l[0]=t=>T.value=!1),color:T.value?void 0:"primary",variant:T.value?"outlined":"flat"},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-view-grid")]),_:1})]),_:1},8,["color","variant"]),a(f,{onClick:l[1]||(l[1]=t=>T.value=!0),color:T.value?"primary":void 0,variant:T.value?"flat":"outlined"},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-view-list")]),_:1})]),_:1},8,["color","variant"])]),_:1}),a(f,{class:"ml-2",onClick:De,"prepend-icon":"mdi-eye-settings-outline",color:b.value?"primary":void 0,variant:b.value?"flat":"outlined"},{default:e(()=>[o(p(b.value?"隐藏系统插件":"显示系统插件"),1)]),_:1},8,["color","variant"]),a(f,{class:"ml-2","prepend-icon":"mdi-tune-vertical",color:"primary",variant:"outlined",onClick:Te},{default:e(()=>[o(" 平台命令配置 ")]),_:1})]),_:1}),a(H,{cols:"12",sm:"auto",md:"6",class:"ml-auto"},{default:e(()=>[n("div",ya,[a(Ge,{modelValue:Z.value,"onUpdate:modelValue":l[2]||(l[2]=t=>Z.value=t),density:"compact",label:"Search","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":""},null,8,["modelValue"])]),_.message?(i(),y(G,{key:0,"max-width":"500px"},{activator:e(({props:t})=>[a(f,$e(t,{icon:"",size:"small",color:"error",class:"ml-2",variant:"tonal"}),{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-alert-circle")]),_:1}),a(We,{dot:"",color:"error",floating:""})]),_:2},1040)]),default:e(({isActive:t})=>[a(U,{class:"rounded-lg"},{default:e(()=>[a(O,{class:"headline d-flex align-center"},{default:e(()=>[a(m,{color:"error",class:"mr-2"},{default:e(()=>[o("mdi-alert-circle")]),_:1}),o(" 错误信息 ")]),_:1}),a(M,null,{default:e(()=>[n("p",ka,p(_.message),1),wa]),_:1}),a(F,null,{default:e(()=>[a(I),a(f,{color:"primary",onClick:r=>t.value=!1},{default:e(()=>[o("关闭")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})):w("",!0)]),_:1})]),_:1}),a(Ke,{"hide-on-leave":""},{default:e(()=>[T.value?(i(),h("div",ba,[a(U,{class:"rounded-lg overflow-hidden elevation-1"},{default:e(()=>[a(ze,{headers:Se,items:oe.value,loading:ee.value,"item-key":"name",hover:""},{loader:e(()=>[a(N,{class:"py-8 d-flex align-center justify-center"},{default:e(()=>[a(se,{indeterminate:"",color:"primary"}),xa]),_:1})]),"item.name":e(({item:t})=>[n("div",Ca,[n("div",null,[n("div",Va,p(t.name),1),t.reserved?(i(),h("div",$a,[a(te,{color:"primary",size:"x-small",class:"font-weight-medium"},{default:e(()=>[o("系统")]),_:1})])):w("",!0)])])]),"item.desc":e(({item:t})=>[n("div",za,p(t.desc),1)]),"item.version":e(({item:t})=>[n("div",Ea,[n("span",Pa,p(t.version),1),t.has_update?(i(),y(m,{key:0,color:"warning",size:"small",class:"ml-1"},{default:e(()=>[o("mdi-alert")]),_:1})):w("",!0),t.has_update?(i(),y(E,{key:1,activator:"parent"},{default:e(()=>[n("span",null,"有新版本: "+p(t.online_version),1)]),_:2},1024)):w("",!0)])]),"item.author":e(({item:t})=>[n("div",Ua,p(t.author),1)]),"item.status":e(({item:t})=>[a(te,{color:t.activated?"success":"error",size:"small",class:"font-weight-medium",variant:t.activated?"flat":"outlined"},{default:e(()=>[o(p(t.activated?"启用":"禁用"),1)]),_:2},1032,["color","variant"])]),"item.actions":e(({item:t})=>[n("div",Sa,[a(Ve,{density:"comfortable",variant:"text",color:"primary"},{default:e(()=>[t.activated?(i(),y(f,{key:1,icon:"",size:"small",color:"error",onClick:r=>ge(t)},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-pause")]),_:1}),a(E,{activator:"parent",location:"top"},{default:e(()=>[o("点击禁用")]),_:1})]),_:2},1032,["onClick"])):(i(),y(f,{key:0,icon:"",size:"small",color:"success",onClick:r=>ve(t)},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-play")]),_:1}),a(E,{activator:"parent",location:"top"},{default:e(()=>[o("点击启用")]),_:1})]),_:2},1032,["onClick"])),a(f,{icon:"",size:"small",color:"info",onClick:r=>ye(t.name)},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-refresh")]),_:1}),a(E,{activator:"parent",location:"top"},{default:e(()=>[o("重载")]),_:1})]),_:2},1032,["onClick"]),a(f,{icon:"",size:"small",onClick:r=>ne(t.name)},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-cog")]),_:1}),a(E,{activator:"parent",location:"top"},{default:e(()=>[o("配置")]),_:1})]),_:2},1032,["onClick"]),a(f,{icon:"",size:"small",onClick:r=>he(t)},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-information")]),_:1}),a(E,{activator:"parent",location:"top"},{default:e(()=>[o("行为")]),_:1})]),_:2},1032,["onClick"]),t.repo?(i(),y(f,{key:2,icon:"",size:"small",onClick:r=>ke(t)},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-book-open-page-variant")]),_:1}),a(E,{activator:"parent",location:"top"},{default:e(()=>[o("文档")]),_:1})]),_:2},1032,["onClick"])):w("",!0),a(f,{icon:"",size:"small",color:"warning",onClick:r=>_e(t.name),"v-show":t.has_update},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-update")]),_:1}),a(E,{activator:"parent",location:"top"},{default:e(()=>[o("更新")]),_:1})]),_:2},1032,["onClick","v-show"]),a(f,{icon:"",size:"small",color:"error",onClick:r=>pe(t.name),disabled:t.reserved},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-delete")]),_:1}),a(E,{activator:"parent",location:"top"},{default:e(()=>[o("卸载")]),_:1})]),_:2},1032,["onClick","disabled"])]),_:2},1024)])]),"no-data":e(()=>[n("div",Da,[a(m,{size:"64",color:"info",class:"mb-4"},{default:e(()=>[o("mdi-puzzle-outline")]),_:1}),Ra,Ta])]),_:1},8,["items","loading"])]),_:1})])):(i(),h("div",La,[oe.value.length===0?(i(),y(N,{key:0,class:"text-center"},{default:e(()=>[a(H,{cols:"12",class:"pa-8"},{default:e(()=>[a(m,{size:"64",color:"info",class:"mb-4"},{default:e(()=>[o("mdi-puzzle-outline")]),_:1}),ja,Ma]),_:1})]),_:1})):w("",!0),a(N,null,{default:e(()=>[(i(!0),h(J,null,le(oe.value,t=>(i(),y(H,{cols:"12",md:"6",lg:"4",key:t.name,class:"pb-4"},{default:e(()=>[a(Me,{extension:t,class:"h-120 rounded-lg",onConfigure:r=>ne(t.name),onUninstall:r=>pe(t.name),onUpdate:r=>_e(t.name),onReload:r=>ye(t.name),onToggleActivation:r=>t.activated?ge(t):ve(t),onViewHandlers:r=>he(t),onViewReadme:r=>ke(t)},null,8,["extension","onConfigure","onUninstall","onUpdate","onReload","onToggleActivation","onViewHandlers","onViewReadme"])]),_:2},1024))),128))]),_:1})]))]),_:1}),ee.value?(i(),y(N,{key:0},{default:e(()=>[a(H,{cols:"12",class:"d-flex justify-center"},{default:e(()=>[a(se,{indeterminate:"",color:"primary",size:"48"})]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),a(G,{modelValue:B.value,"onUpdate:modelValue":l[5]||(l[5]=t=>B.value=t),"max-width":"900",persistent:""},{default:e(()=>[a(U,{class:"rounded-lg"},{default:e(()=>[a(qe,{color:"primary",density:"comfortable",flat:""},{default:e(()=>[a(Je,{class:"text-white"},{default:e(()=>[o("平台命令可用性配置")]),_:1}),a(I),a(f,{icon:"",onClick:l[3]||(l[3]=t=>B.value=!1),variant:"text",color:"white"},{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-close")]),_:1})]),_:1})]),_:1}),a(M,{class:"pt-4"},{default:e(()=>[Ia,a(Qe,{"model-value":K.value,class:"align-center justify-center",persistent:""},{default:e(()=>[a(se,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),c.platforms.length===0?(i(),h("div",Aa,[a(m,{icon:"mdi-alert",color:"warning",size:"64",class:"mb-4"}),Ba,Na,a(f,{color:"primary",to:"/platforms",variant:"elevated"},{default:e(()=>[o("前往平台管理")]),_:1})])):(i(),y(aa,{key:1,class:"rounded-lg overflow-hidden"},{default:e(()=>[a(Ye,{hover:"",class:"elevation-1"},{default:e(()=>[n("thead",null,[n("tr",null,[Ha,(i(!0),h(J,null,le(c.platforms,t=>(i(),h("th",{key:t.name},[n("div",Oa,[o(p(t.display_name)+" ",1),a(Xe,null,{activator:e(({props:r})=>[a(f,$e({icon:"",density:"compact",variant:"text",size:"small"},r,{class:"ms-1"}),{default:e(()=>[a(m,null,{default:e(()=>[o("mdi-dots-vertical")]),_:1})]),_:2},1040)]),default:e(()=>[a(Ze,null,{default:e(()=>[a(Q,{onClick:r=>ae(t.name,!0)},{default:e(()=>[a(Y,null,{default:e(()=>[o("全选")]),_:1})]),_:2},1032,["onClick"]),a(Q,{onClick:r=>ae(t.name,!0,!1)},{default:e(()=>[a(Y,null,{default:e(()=>[o("全选普通插件")]),_:1})]),_:2},1032,["onClick"]),a(Q,{onClick:r=>ae(t.name,!0,!0)},{default:e(()=>[a(Y,null,{default:e(()=>[o("全选系统插件")]),_:1})]),_:2},1032,["onClick"]),a(Q,{onClick:r=>ae(t.name,!1)},{default:e(()=>[a(Y,null,{default:e(()=>[o("全不选")]),_:1})]),_:2},1032,["onClick"]),a(Q,{onClick:r=>je(t.name)},{default:e(()=>[a(Y,null,{default:e(()=>[o("反选")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])]))),128))])]),n("tbody",null,[(i(!0),h(J,null,le(c.plugins,t=>(i(),h("tr",{key:t.name},[n("td",null,[n("div",Fa,[o(p(t.name)+" ",1),t.reserved?(i(),y(te,{key:0,color:"primary",size:"x-small",class:"ml-2"},{default:e(()=>[o("系统")]),_:1})):w("",!0)]),n("div",Ga,p(t.desc),1)]),(i(!0),h(J,null,le(c.platforms,r=>(i(),h("td",{key:r.name},[a(ea,{modelValue:c.platform_enable[r.name][t.name],"onUpdate:modelValue":$=>c.platform_enable[r.name][t.name]=$,"hide-details":"",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]))),128))]))),128))])]),_:1})]),_:1}))]),_:1}),a(F,null,{default:e(()=>[a(I),a(f,{color:"grey",text:"",onClick:l[4]||(l[4]=t=>B.value=!1)},{default:e(()=>[o("关闭")]),_:1}),c.platforms.length>0?(i(),y(f,{key:0,color:"primary",onClick:Le},{default:e(()=>[o("保存")]),_:1})):w("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(G,{modelValue:D.value,"onUpdate:modelValue":l[7]||(l[7]=t=>D.value=t),width:"1000"},{default:e(()=>[a(U,null,{default:e(()=>[a(O,{class:"text-h5"},{default:e(()=>[o("插件配置")]),_:1}),a(M,null,{default:e(()=>[V.metadata?(i(),y(Ae,{key:0,metadata:V.metadata,iterable:V.config,metadataKey:W.value},null,8,["metadata","iterable","metadataKey"])):(i(),h("p",Wa,"这个插件没有配置"))]),_:1}),a(F,null,{default:e(()=>[a(I),a(f,{color:"blue-darken-1",variant:"text",onClick:Re},{default:e(()=>[o("保存并关闭")]),_:1}),a(f,{color:"blue-darken-1",variant:"text",onClick:l[6]||(l[6]=t=>D.value=!1)},{default:e(()=>[o("关闭")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(G,{modelValue:d.show,"onUpdate:modelValue":l[8]||(l[8]=t=>d.show=t),width:"700",persistent:""},{default:e(()=>[a(U,null,{default:e(()=>[a(O,{class:"text-h5"},{default:e(()=>[o(p(d.title),1)]),_:1}),a(M,null,{default:e(()=>[d.statusCode===0?(i(),y(ta,{key:0,indeterminate:"",color:"primary",class:"mb-4"})):w("",!0),d.statusCode!==0?(i(),h("div",Ka,[a(m,{class:"mb-6",color:d.statusCode===1?"success":"error",icon:d.statusCode===1?"mdi-check-circle-outline":"mdi-alert-circle-outline",size:"128"},null,8,["color","icon"]),n("div",qa,p(d.result),1)])):w("",!0),n("div",Ja,[Qa,a(Be,{historyNum:"10",style:{height:"200px","margin-top":"16px"}})])]),_:1}),a(F,null,{default:e(()=>[a(I),a(f,{color:"blue-darken-1",variant:"text",onClick:ce},{default:e(()=>[o("关闭")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(G,{modelValue:v.value,"onUpdate:modelValue":l[10]||(l[10]=t=>v.value=t),width:"1200"},{default:e(()=>[a(U,null,{default:e(()=>[a(O,{class:"text-h5"},{default:e(()=>[o(p(k.value.name)+" 插件行为",1)]),_:1}),a(M,null,{default:e(()=>[a(ze,{style:{"font-size":"17px"},headers:Ue,items:k.value.handlers,"item-key":"name"},{"header.id":e(({column:t})=>[n("p",Ya,p(t.title),1)]),"item.event_type":e(({item:t})=>[o(p(t.event_type),1)]),"item.desc":e(({item:t})=>[o(p(t.desc),1)]),"item.type":e(({item:t})=>[a(te,{color:"success"},{default:e(()=>[o(p(t.type),1)]),_:2},1024)]),"item.cmd":e(({item:t})=>[n("span",Xa,p(t.cmd),1)]),_:1},8,["items"])]),_:1}),a(F,null,{default:e(()=>[a(I),a(f,{color:"blue-darken-1",variant:"text",onClick:l[9]||(l[9]=t=>v.value=!1)},{default:e(()=>[o("关闭")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(He,{timeout:2e3,elevation:"24",color:A.value,modelValue:S.value,"onUpdate:modelValue":l[11]||(l[11]=t=>S.value=t)},{default:e(()=>[o(p(P.value),1)]),_:1},8,["color","modelValue"]),a(Ie,{ref_key:"wfr",ref:Pe},null,512),a(ga,{show:R.show,"onUpdate:show":l[12]||(l[12]=t=>R.show=t),"plugin-name":R.pluginName,"repo-url":R.repoUrl},null,8,["show","plugin-name","repo-url"])],64))}},ct=na(Za,[["__scopeId","data-v-fcccae10"]]);export{ct as default};
